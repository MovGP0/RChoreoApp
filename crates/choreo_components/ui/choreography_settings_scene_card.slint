import { CheckBoxTile, CheckState, MaterialPalette, MaterialText, TextField, Vertical } from "@material";
import { ColorPicker } from "color_picker.slint";
import { NumberPicker } from "number_picker.slint";
import { Translations } from "translations.slint";

export component ChoreographySettingsSceneCard inherits Rectangle {
    in property <bool> has_selected_scene;
    in property <string> scene_name;
    in property <string> scene_text;
    in property <bool> scene_fixed_positions;
    in property <bool> scene_has_timestamp;
    in property <int> scene_timestamp_minutes;
    in property <int> scene_timestamp_seconds;
    in property <int> scene_timestamp_millis;
    in-out property <color> scene_color;

    callback update_scene_name(string);
    callback update_scene_text(string);
    callback update_scene_fixed_positions(bool);
    callback update_scene_has_timestamp(bool);
    callback update_scene_timestamp_parts(int, int, int);
    callback update_scene_color(color);

    background: MaterialPalette.surface_container;
    border-width: 1px;
    border-color: MaterialPalette.outline_variant;
    border-radius: 8px;

    Vertical {
        padding: 12px;
        spacing: 8px;

        MaterialText {
            text: Translations.scene_section_title;
            font-size: 18px;
        }

        TextField {
            label: Translations.scene_name_label;
            text: root.scene_name;
            enabled: root.has_selected_scene;
            edited(new_value) => { root.update_scene_name(new_value); }
        }

        TextField {
            label: Translations.scene_text_label;
            text: root.scene_text;
            enabled: root.has_selected_scene;
            edited(new_value) => { root.update_scene_text(new_value); }
        }

        HorizontalLayout {
            spacing: 8px;
            MaterialText {
                text: Translations.scene_fixed_positions_label;
                vertical-alignment: center;
                color: MaterialPalette.on_surface_variant;
            }
            Rectangle { horizontal-stretch: 1; background: transparent; }
            CheckBoxTile {
                text: "";
                check_state: root.scene_fixed_positions ? CheckState.checked : CheckState.unchecked;
                enabled: root.has_selected_scene;
                checked_state_changed(state) => {
                    root.update_scene_fixed_positions(state == CheckState.checked);
                }
            }
        }

        HorizontalLayout {
            spacing: 8px;
            MaterialText {
                text: Translations.scene_timestamp_label;
                vertical-alignment: center;
                color: MaterialPalette.on_surface_variant;
            }
            Rectangle { horizontal-stretch: 1; background: transparent; }
            CheckBoxTile {
                text: "";
                check_state: root.scene_has_timestamp ? CheckState.checked : CheckState.unchecked;
                enabled: root.has_selected_scene;
                checked_state_changed(state) => {
                    root.update_scene_has_timestamp(state == CheckState.checked);
                }
            }
        }

        NumberPicker {
            label: Translations.scene_timestamp_minutes_label;
            value: root.scene_timestamp_minutes;
            minimum: 0;
            maximum: 1440;
            step: 1;
            enabled: root.has_selected_scene && root.scene_has_timestamp;
            value_changed(value) => {
                root.update_scene_timestamp_parts(value, root.scene_timestamp_seconds, root.scene_timestamp_millis);
            }
        }

        NumberPicker {
            label: Translations.scene_timestamp_seconds_label;
            value: root.scene_timestamp_seconds;
            minimum: 0;
            maximum: 59;
            step: 1;
            enabled: root.has_selected_scene && root.scene_has_timestamp;
            value_changed(value) => {
                root.update_scene_timestamp_parts(root.scene_timestamp_minutes, value, root.scene_timestamp_millis);
            }
        }

        NumberPicker {
            label: Translations.scene_timestamp_milliseconds_label;
            value: root.scene_timestamp_millis;
            minimum: 0;
            maximum: 999;
            step: 10;
            enabled: root.has_selected_scene && root.scene_has_timestamp;
            value_changed(value) => {
                root.update_scene_timestamp_parts(root.scene_timestamp_minutes, root.scene_timestamp_seconds, value);
            }
        }

        MaterialText {
            text: Translations.scene_color_label;
            color: MaterialPalette.on_surface_variant;
        }
        ColorPicker {
            selected_color: root.scene_color;
            color_changed(color) => { root.update_scene_color(color); }
        }
    }
}
