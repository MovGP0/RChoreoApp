import { IconButton, MaterialPalette, MaterialTypography } from "@material";
import { Translations } from "translations.slint";

export component SceneSearchBar inherits Rectangle {
    in-out property <string> text <=> search_input.text;
    in property <string> placeholder_text: Translations.search_placeholder;

    callback edited(string);

    background: MaterialPalette.surface_container_high;
    border-radius: 12px;
    border-width: 1px;
    border-color: MaterialPalette.outline_variant;
    height: 44px;

    Image {
        x: 10px;
        y: parent.height / 2 - self.height / 2;
        source: @image-url("icons/Magnify.svg");
        width: 18px;
        height: 18px;
        colorize: MaterialPalette.on_surface_variant;
    }

    search_input := TextInput {
        x: 36px;
        y: 0px;
        width: max(0px, parent.width - self.x - 40px);
        height: parent.height;
        single-line: true;
        vertical-alignment: center;
        color: MaterialPalette.on_surface;
        font-size: MaterialTypography.body_medium.font_size;
        font-weight: MaterialTypography.body_medium.font_weight;
        selection-background-color: MaterialPalette.secondary_container;
        selection-foreground-color: MaterialPalette.on_secondary_container;

        edited => {
            root.edited(self.text);
        }
    }

    if search_input.text == "" : Text {
        x: search_input.x;
        y: 0px;
        width: search_input.width;
        height: parent.height;
        text: root.placeholder_text;
        color: MaterialPalette.on_surface_variant;
        font-size: MaterialTypography.body_medium.font_size;
        font-weight: MaterialTypography.body_medium.font_weight;
        vertical-alignment: center;
    }

    IconButton {
        visible: search_input.text != "";
        enabled: search_input.text != "";
        x: parent.width - self.width - 4px;
        y: parent.height / 2 - self.height / 2;
        icon: @image-url("icons/Close.svg");
        tooltip: Translations.common_cancel;
        clicked => {
            search_input.text = "";
            root.edited("");
        }
    }
}
